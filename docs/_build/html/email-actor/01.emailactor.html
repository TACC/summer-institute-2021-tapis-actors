
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Send Email Message From Actor &#8212; TACC Summer Institute Tapis Actors  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p>In this section, let us create the actor from the Docker container and test it by sending a message.</p>
<div class="section" id="send-email-message-from-actor">
<h1>Send Email Message From Actor<a class="headerlink" href="#send-email-message-from-actor" title="Permalink to this headline">¶</a></h1>
<p>The function of an actor is exposed as the default command in a Docker
container. Let us create an actor from an existing Docker container image
called <strong>tacc/email-actor:latest</strong> available on
<a class="reference external" href="https://hub.docker.com/repository/docker/tacc/email-actor">Docker Hub</a>.
The default command for this container emails the message “Hello, World” or
the message sent to it, which will be captured in the actor logs.</p>
<p>Create the actor as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tapis actors create --repo tacc/email-actor:latest <span class="se">\</span>
                      -n email-actor <span class="se">\</span>
                      -d <span class="s2">&quot;Test actor that emails Hello, World&quot;</span>
                      -E secrets.json
 +----------------+----------------------------+
 <span class="p">|</span> Field          <span class="p">|</span> Value                      <span class="p">|</span>
 +----------------+----------------------------+
 <span class="p">|</span> id             <span class="p">|</span> w66kex1yD7Ql               <span class="p">|</span>
 <span class="p">|</span> name           <span class="p">|</span> email-actor                <span class="p">|</span>
 <span class="p">|</span> owner          <span class="p">|</span> sgopal                     <span class="p">|</span>
 <span class="p">|</span> image          <span class="p">|</span> reshg/email-actor:latest   <span class="p">|</span>
 <span class="p">|</span> lastUpdateTime <span class="p">|</span> <span class="m">2021</span>-08-24T14:31:58.248860 <span class="p">|</span>
 <span class="p">|</span> status         <span class="p">|</span> SUBMITTED                  <span class="p">|</span>
 +----------------+----------------------------+
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--repo</span></code> flag points to the Docker Hub repo on which this actor is based,
the <code class="docutils literal notranslate"><span class="pre">-n</span></code> flag and <code class="docutils literal notranslate"><span class="pre">-d</span></code> flag attach a human-readable name and description to
the actor.</p>
<p>The resulting actor is assigned an id: <code class="docutils literal notranslate"><span class="pre">w66kex1yD7Ql</span></code>. The actor id can be
queried by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> $ tapis actors show -v w66kex1yD7Ql
 <span class="o">{</span>
    <span class="s2">&quot;id&quot;</span>: <span class="s2">&quot;w66kex1yD7Ql&quot;</span>,
    <span class="s2">&quot;name&quot;</span>: <span class="s2">&quot;email-actor&quot;</span>,
    <span class="s2">&quot;description&quot;</span>: <span class="s2">&quot;Actor that emails the message&quot;</span>,
    <span class="s2">&quot;owner&quot;</span>: <span class="s2">&quot;taccuser&quot;</span>,
    <span class="s2">&quot;image&quot;</span>: <span class="s2">&quot;tacc/email-actor:latest&quot;</span>,
    <span class="s2">&quot;createTime&quot;</span>: <span class="s2">&quot;2021-08-24T14:31:58.248Z&quot;</span>,
    <span class="s2">&quot;lastUpdateTime&quot;</span>: <span class="s2">&quot;2021-08-24T14:31:58.248Z&quot;</span>,
    <span class="s2">&quot;defaultEnvironment&quot;</span>: <span class="o">{}</span>,
    <span class="s2">&quot;gid&quot;</span>: <span class="m">862347</span>,
    <span class="s2">&quot;hints&quot;</span>: <span class="o">[]</span>,
    <span class="s2">&quot;link&quot;</span>: <span class="s2">&quot;&quot;</span>,
    <span class="s2">&quot;mounts&quot;</span>: <span class="o">[</span>
     <span class="o">{</span>
        <span class="s2">&quot;container_path&quot;</span>: <span class="s2">&quot;/work&quot;</span>,
        <span class="s2">&quot;host_path&quot;</span>: <span class="s2">&quot;/work&quot;</span>,
        <span class="s2">&quot;mode&quot;</span>: <span class="s2">&quot;rw&quot;</span>
     <span class="o">}</span>,
     <span class="o">{</span>
      <span class="s2">&quot;container_path&quot;</span>: <span class="s2">&quot;/corral&quot;</span>,
      <span class="s2">&quot;host_path&quot;</span>: <span class="s2">&quot;/corral-repl/projects/SD2E-Community&quot;</span>,
      <span class="s2">&quot;mode&quot;</span>: <span class="s2">&quot;rw&quot;</span>
     <span class="o">}</span>
    <span class="o">]</span>,
    <span class="s2">&quot;privileged&quot;</span>: false,
    <span class="s2">&quot;queue&quot;</span>: <span class="s2">&quot;default&quot;</span>,
    <span class="s2">&quot;stateless&quot;</span>: true,
    <span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;READY&quot;</span>,
    <span class="s2">&quot;statusMessage&quot;</span>: <span class="s2">&quot; &quot;</span>,
    <span class="s2">&quot;token&quot;</span>: true,
    <span class="s2">&quot;uid&quot;</span>: <span class="m">862347</span>,
    <span class="s2">&quot;useContainerUid&quot;</span>: false,
    <span class="s2">&quot;webhook&quot;</span>: <span class="s2">&quot;&quot;</span>,
    <span class="s2">&quot;_links&quot;</span>: <span class="o">{</span>
      <span class="s2">&quot;executions&quot;</span>: <span class="s2">&quot;https://api.sd2e.org/actors/v2/w66kex1yD7Ql/executions&quot;</span>,
      <span class="s2">&quot;owner&quot;</span>: <span class="s2">&quot;https://api.sd2e.org/profiles/v2/sgopal&quot;</span>,
      <span class="s2">&quot;self&quot;</span>: <span class="s2">&quot;https://api.sd2e.org/actors/v2/w66kex1yD7Ql&quot;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Above, you can see the plain text name, description that were passed on the command line. In addition, you can see the
“status” of the actor is “READY”, meaning it is ready to receive and act on
messages. Finally, you can list all actors visible to you with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tapis actors list
+---------------+---------------+----------+-----------------------------+----------------------------+--------+-------+
<span class="p">|</span> id            <span class="p">|</span> name          <span class="p">|</span> owner    <span class="p">|</span> image                       <span class="p">|</span> lastUpdateTime             <span class="p">|</span> status <span class="p">|</span> cronOn<span class="p">|</span>
+---------------+---------------+----------+-----------------------------+----------------------------+--------+-------+
<span class="p">|</span> w66kex1yD7Ql  <span class="p">|</span> email-actor   <span class="p">|</span> taccuser <span class="p">|</span> tacc/email-actor:latest     <span class="p">|</span> <span class="m">2021</span>-08-14T22:25:06.171Z   <span class="p">|</span> READY  <span class="p">|</span> False <span class="p">|</span>
+---------------+---------------+----------+-----------------------------+----------------------------+--------+-------+
</pre></div>
</div>
</div>
<div class="section" id="submit-a-message-to-the-actor">
<h1>Submit a Message to the Actor<a class="headerlink" href="#submit-a-message-to-the-actor" title="Permalink to this headline">¶</a></h1>
<p>Next, let’s craft a simple message to send to the reactor. Messages can be plain
text or in JSON format. When using the python actor libraries as in the example
above, JSON-formatted messages are made available as python dictionaries.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write a message</span>
$ <span class="nb">export</span> <span class="nv">MESSAGE</span><span class="o">=</span><span class="s1">&#39;Hello, World&#39;</span>
$ <span class="nb">echo</span> <span class="nv">$MESSAGE</span>
Hello, World

$ Submit the message to the actor
$ tapis actors submit -m <span class="s2">&quot;</span><span class="nv">$MESSAGE</span><span class="s2">&quot;</span> w66kex1yD7Ql
+-------------+---------------+
<span class="p">|</span>  Field      <span class="p">|</span> Value         <span class="p">|</span>
+-------------+---------------+
<span class="p">|</span> executionId <span class="p">|</span> w1plap4NalAWb <span class="p">|</span>
<span class="p">|</span> msg         <span class="p">|</span> Hello, World  <span class="p">|</span>
+-------------+---------------+
</pre></div>
</div>
<p>The id of the actor (<code class="docutils literal notranslate"><span class="pre">N4xQ5WM5Np1X0</span></code>) was used on the command line to specify
which actor should receive the message. In response, an “execution id”
(<code class="docutils literal notranslate"><span class="pre">N4xQ5WM5Np1X0</span></code>) is returned. An execution is a specific instance of an actor.
List all the executions for a given actor as:</p>
<p>The above execution has already completed. Show detailed information for the
execution with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> $ tapis actors execs show -v w66kex1yD7Ql w1plap4NalAWb
 <span class="o">{</span>
    <span class="s2">&quot;actorId&quot;</span>: <span class="s2">&quot;w66kex1yD7Ql&quot;</span>,
    <span class="s2">&quot;apiServer&quot;</span>: <span class="s2">&quot;https://api.sd2e.org&quot;</span>,
    <span class="s2">&quot;cpu&quot;</span>: <span class="m">559911564</span>,
    <span class="s2">&quot;exitCode&quot;</span>: <span class="m">0</span>,
    <span class="s2">&quot;finalState&quot;</span>: <span class="o">{</span>
        <span class="s2">&quot;Dead&quot;</span>: false,
        <span class="s2">&quot;Error&quot;</span>: <span class="s2">&quot;&quot;</span>,
        <span class="s2">&quot;ExitCode&quot;</span>: <span class="m">0</span>,
        <span class="s2">&quot;FinishedAt&quot;</span>: <span class="s2">&quot;2021-08-24T14:33:48.879Z&quot;</span>,
        <span class="s2">&quot;OOMKilled&quot;</span>: false,
        <span class="s2">&quot;Paused&quot;</span>: false,
        <span class="s2">&quot;Pid&quot;</span>: <span class="m">0</span>,
        <span class="s2">&quot;Restarting&quot;</span>: false,
        <span class="s2">&quot;Running&quot;</span>: false,
        <span class="s2">&quot;StartedAt&quot;</span>: <span class="s2">&quot;2021-08-24T14:33:47.049Z&quot;</span>,
        <span class="s2">&quot;Status&quot;</span>: <span class="s2">&quot;exited&quot;</span>
    <span class="o">}</span>,
    <span class="s2">&quot;id&quot;</span>: <span class="s2">&quot;w1plap4NalAWb&quot;</span>,
    <span class="s2">&quot;io&quot;</span>: <span class="m">7349</span>,
    <span class="s2">&quot;messageReceivedTime&quot;</span>: <span class="s2">&quot;2021-08-24T14:33:45.714Z&quot;</span>,
    <span class="s2">&quot;runtime&quot;</span>: <span class="m">2</span>,
    <span class="s2">&quot;startTime&quot;</span>: <span class="s2">&quot;2021-08-24T14:33:46.565Z&quot;</span>,
    <span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;COMPLETE&quot;</span>,
    <span class="s2">&quot;workerId&quot;</span>: <span class="s2">&quot;E6LW3MrpyAOa&quot;</span>,
    <span class="s2">&quot;_links&quot;</span>: <span class="o">{</span>
        <span class="s2">&quot;logs&quot;</span>: <span class="s2">&quot;https://api.sd2e.org/actors/v2/w66kex1yD7Ql/executions/w1plap4NalAWb/logs&quot;</span>,
        <span class="s2">&quot;owner&quot;</span>: <span class="s2">&quot;https://api.sd2e.org/profiles/v2/sgopal&quot;</span>,
        <span class="s2">&quot;self&quot;</span>: <span class="s2">&quot;https://api.sd2e.org/actors/v2/w66kex1yD7Ql/executions/w1plap4NalAWb&quot;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="check-the-logs-for-an-execution">
<h1>Check the Logs for an Execution<a class="headerlink" href="#check-the-logs-for-an-execution" title="Permalink to this headline">¶</a></h1>
<p>An execution’s logs will contain whatever was printed to STDOUT / STDERR by the
actor. In our demo actor, we expect the actor to print the message passed to it, and
email the message to the recipient email address we mentioned above.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tapis actors execs logs w66kex1yD7Ql w1plap4NalAWb
Logs <span class="k">for</span> execution w1plap4NalAWb
 Actor received message: Hello, World
 Message emailed successfully!
</pre></div>
</div>
<p>Check your email for the message.
Did you get it? Hooray!</p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">TACC Summer Institute Tapis Actors</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hello-world-actor/00.buildhelloworld.html">Work with Actors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hello-world-actor/00.buildhelloworld.html#hello-world-actor">Hello World Actor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hello-world-actor/00.buildhelloworld.html#install-the-cli">Install the CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hello-world-actor/00.buildhelloworld.html#initialize-a-tapis-session">Initialize a Tapis Session</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hello-world-actor/00.buildhelloworld.html#create-a-new-actor">Create a New Actor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../upstream-messenger/00.deployupstream.html">Automating Work at TACC Tutorial: Messaging Between Actors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Texas Advanced Computing Center.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/email-actor/01.emailactor.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>